<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRU Standardization Tool</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        #total-composition {
            font-weight: bold;
            font-size: 16px;
        }
            margin: 30px auto;
            max-width: 600px;
            text-align: center;
        // Validation functions
        function validateQuery() {.container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #0056b3;
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1 {
            margin: 0;
            font-size: 2rem;
        }
        .main-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-top: 20px;
        }
        .composition-data {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 30px;
        }
        .composition-data h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #0056b3;
        }
        .composition-data .form-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .composition-data label {
            flex: 0 0 150px;
            text-align: right;
            margin-right: 15px;
            font-weight: 500;
        }
        .composition-data input {
            flex: 0 0 150px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
                .process-flow-diagram {
            margin-bottom: 30px;
        }
        .pfd-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background-color: white;
        }
        .process-flow-diagram h3 {
            color: #0056b3;
            margin-bottom: 10px;
        }
        select {
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
            width: 100%;
            margin-bottom: 20px;
            cursor: pointer;
        }
        button {
            background-color: #0056b3;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #003d82;
        }
        .config-screens {
            display: none;
            margin-top: 30px;
        }
        .config-screen {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .config-screen.active {
            display: block;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .back-button {
            background-color: #6c757d;
            margin-right: 10px;
        }
        .back-button:hover {
            background-color: #5a6268;
        }
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .parameter-table th, .parameter-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        .parameter-table th {
            background-color: #f2f2f2;
        }
        .result-display {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>SRU Standardization Tool</h1>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <div id="welcome-screen">
                <h2>Welcome to the SRU Standardization Tool</h2>
                <p>This tool helps you standardize your SRU configurations and perform various tasks related to SRU implementation.</p>
                
                <div class="composition-data">
                    <h3>Enter Composition Data</h3>
                    <div class="form-group">
                        <label for="h2s">H2S (Mole%):</label>
                        <input type="number" id="h2s" min="0" max="100" step="0.01" placeholder="0.00" onchange="updatePFD()">
                    </div>
                    <div class="form-group">
                        <label for="co2">CO2 (Mole%):</label>
                        <input type="number" id="co2" min="0" max="100" step="0.01" placeholder="0.00" onchange="updatePFD()">
                    </div>
                    <div class="form-group">
                        <label for="nh3">NH3 (Mole%):</label>
                        <input type="number" id="nh3" min="0" max="100" step="0.01" placeholder="0.00" onchange="updatePFD()">
                    </div>
                    <div class="form-group">
                        <label for="btex">BTEX (Mole%):</label>
                        <input type="number" id="btex" min="0" max="100" step="0.01" placeholder="0.00" onchange="updatePFD()">
                    </div>
                    <div class="form-group">
                        <label for="other-hc">Other HC (Mole%):</label>
                        <input type="number" id="other-hc" min="0" max="100" step="0.01" placeholder="0.00" onchange="updatePFD()">
                    </div>
                    <div class="form-group">
                        <button id="calculate-composition" onclick="calculateComposition()">Calculate Total</button>
                        <span id="total-composition" style="margin-left: 10px;"></span>
                    </div>
                </div>
                
                <div class="process-flow-diagram">
                    <h3>Process Flow Diagram</h3>
                    <p>This diagram updates based on your input composition data:</p>
                    <div id="pfd-container" class="pfd-container">
                        <svg id="pfd-svg" width="100%" height="400" viewBox="0 0 800 400">
                            <!-- Background -->
                            <rect x="0" y="0" width="800" height="400" fill="#f8f9fa" stroke="#ddd" stroke-width="1" />
                            
                            <!-- Feed Stream -->
                            <line x1="50" y1="100" x2="200" y2="100" stroke="#0056b3" stroke-width="3" />
                            <polygon points="195,95 205,100 195,105" fill="#0056b3" />
                            <text x="100" y="90" text-anchor="middle" font-size="14">Feed Gas</text>
                            
                            <!-- Thermal Oxidizer/Incinerator -->
                            <rect id="reactor" x="200" y="50" width="100" height="100" fill="#fff" stroke="#333" stroke-width="2" />
                            <text x="250" y="40" text-anchor="middle" font-size="14">Thermal Oxidizer</text>
                            
                            <!-- First Converter -->
                            <rect id="converter1" x="350" y="50" width="100" height="100" fill="#fff" stroke="#333" stroke-width="2" />
                            <text x="400" y="40" text-anchor="middle" font-size="14">1st Converter</text>
                            <text x="400" y="100" text-anchor="middle" font-size="12" id="converter1-text">H₂S → SO₂</text>
                            
                            <!-- Connecting line -->
                            <line x1="300" y1="100" x2="350" y2="100" stroke="#0056b3" stroke-width="3" />
                            <polygon points="345,95 355,100 345,105" fill="#0056b3" />
                            
                            <!-- Cooler -->
                            <rect x="350" y="200" width="100" height="60" fill="#fff" stroke="#333" stroke-width="2" rx="5" ry="5" />
                            <text x="400" y="190" text-anchor="middle" font-size="14">Cooler</text>
                            <line x1="360" y1="210" x2="440" y2="210" stroke="#333" stroke-width="1" />
                            <line x1="360" y1="220" x2="440" y2="220" stroke="#333" stroke-width="1" />
                            <line x1="360" y1="230" x2="440" y2="230" stroke="#333" stroke-width="1" />
                            <line x1="360" y1="240" x2="440" y2="240" stroke="#333" stroke-width="1" />
                            <line x1="360" y1="250" x2="440" y2="250" stroke="#333" stroke-width="1" />
                            
                            <!-- Second Converter -->
                            <rect id="converter2" x="500" y="50" width="100" height="100" fill="#fff" stroke="#333" stroke-width="2" />
                            <text x="550" y="40" text-anchor="middle" font-size="14">2nd Converter</text>
                            <text x="550" y="100" text-anchor="middle" font-size="12" id="converter2-text">SO₂ → S</text>
                            
                            <!-- Connecting line from 1st converter to 2nd -->
                            <line x1="450" y1="100" x2="500" y2="100" stroke="#0056b3" stroke-width="3" />
                            <polygon points="495,95 505,100 495,105" fill="#0056b3" />
                            
                            <!-- Line from 1st converter to cooler -->
                            <line x1="400" y1="150" x2="400" y2="200" stroke="#0056b3" stroke-width="3" />
                            <polygon points="395,195 400,205 405,195" fill="#0056b3" />
                            
                            <!-- Line from cooler to 2nd converter -->
                            <line x1="450" y1="230" x2="550" y2="230" stroke="#0056b3" stroke-width="3" />
                            <line x1="550" y1="230" x2="550" y2="150" stroke="#0056b3" stroke-width="3" />
                            <polygon points="545,155 550,145 555,155" fill="#0056b3" />
                            
                            <!-- Sulfur Output -->
                            <line x1="600" y1="100" x2="700" y2="100" stroke="#d4af37" stroke-width="3" />
                            <polygon points="695,95 705,100 695,105" fill="#d4af37" />
                            <text x="650" y="90" text-anchor="middle" font-size="14">Liquid Sulfur</text>
                            
                            <!-- Tail Gas -->
                            <line x1="550" y1="150" x2="550" y2="300" stroke="#888" stroke-width="2" stroke-dasharray="5,5" />
                            <text x="550" y="320" text-anchor="middle" font-size="14">Tail Gas</text>
                            
                            <!-- Component percentages -->
                            <g id="component-labels" font-size="12">
                                <text x="100" y="125" text-anchor="middle" id="feed-h2s">H₂S: 0.00%</text>
                                <text x="100" y="145" text-anchor="middle" id="feed-co2">CO₂: 0.00%</text>
                                <text x="100" y="165" text-anchor="middle" id="feed-nh3">NH₃: 0.00%</text>
                                <text x="650" y="125" text-anchor="middle" id="sulfur-output">Purity: 0.00%</text>
                            </g>
                        </svg>
                    </div>
                </div>
                
                <p>Please select a configuration option below to get started:</p>
                
                <div class="config-selector">
                    <select id="config-dropdown">
                        <option value="" selected disabled>Select a Configuration Option</option>
                        <option value="basic-parameters">Basic Parameters Configuration</option>
                        <option value="advanced-settings">Advanced Settings Configuration</option>
                        <option value="protocol-config">Protocol Configuration</option>
                        <option value="performance-tuning">Performance Tuning</option>
                        <option value="validation">Validation Tools</option>
                    </select>
                    <button id="proceed-button">Proceed</button>
                </div>
            </div>

            <div class="config-screens" id="config-screens">
                <!-- Basic Parameters Configuration Screen -->
                <div class="config-screen" id="basic-parameters-screen">
                    <h2>Basic Parameters Configuration</h2>
                    
                    <div class="form-group">
                        <label for="server-url">Server URL:</label>
                        <input type="text" id="server-url" placeholder="Enter SRU server URL">
                    </div>
                    
                    <div class="form-group">
                        <label for="version">SRU Version:</label>
                        <select id="version">
                            <option value="1.1">SRU 1.1</option>
                            <option value="1.2" selected>SRU 1.2</option>
                            <option value="2.0">SRU 2.0</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="operation">Default Operation:</label>
                        <select id="operation">
                            <option value="searchRetrieve">searchRetrieve</option>
                            <option value="explain">explain</option>
                            <option value="scan">scan</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="record-schema">Record Schema:</label>
                        <input type="text" id="record-schema" placeholder="Enter record schema" value="dc">
                    </div>
                    
                    <div class="form-group">
                        <button class="back-button" onclick="showWelcomeScreen()">Back</button>
                        <button onclick="saveBasicParameters()">Save Configuration</button>
                    </div>
                    
                    <div class="result-display" id="basic-result" style="display: none;">
                        Configuration saved successfully!
                    </div>
                </div>

                <!-- Advanced Settings Configuration Screen -->
                <div class="config-screen" id="advanced-settings-screen">
                    <h2>Advanced Settings Configuration</h2>
                    
                    <div class="form-group">
                        <label for="max-records">Maximum Records:</label>
                        <input type="number" id="max-records" min="1" max="1000" value="10">
                    </div>
                    
                    <div class="form-group">
                        <label for="start-record">Start Record Position:</label>
                        <input type="number" id="start-record" min="1" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="record-packing">Record Packing:</label>
                        <select id="record-packing">
                            <option value="xml">XML</option>
                            <option value="string">String</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="stylesheet">Stylesheet URL (optional):</label>
                        <input type="text" id="stylesheet" placeholder="Enter stylesheet URL">
                    </div>
                    
                    <div class="form-group">
                        <button class="back-button" onclick="showWelcomeScreen()">Back</button>
                        <button onclick="saveAdvancedSettings()">Save Advanced Settings</button>
                    </div>
                    
                    <div class="result-display" id="advanced-result" style="display: none;">
                        Advanced settings saved successfully!
                    </div>
                </div>

                <!-- Protocol Configuration Screen -->
                <div class="config-screen" id="protocol-config-screen">
                    <h2>Protocol Configuration</h2>
                    
                    <div class="form-group">
                        <label for="auth-method">Authentication Method:</label>
                        <select id="auth-method">
                            <option value="none">None</option>
                            <option value="basic">Basic Auth</option>
                            <option value="oauth">OAuth</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeout">Connection Timeout (seconds):</label>
                        <input type="number" id="timeout" min="1" max="300" value="30">
                    </div>
                    
                    <div class="form-group">
                        <label for="retry-attempts">Retry Attempts:</label>
                        <input type="number" id="retry-attempts" min="0" max="10" value="3">
                    </div>
                    
                    <div class="form-group">
                        <label for="custom-headers">Custom Headers (JSON format):</label>
                        <textarea id="custom-headers" rows="4" placeholder='{"X-Custom-Header": "Value"}'></textarea>
                    </div>
                    
                    <div class="form-group">
                        <button class="back-button" onclick="showWelcomeScreen()">Back</button>
                        <button onclick="saveProtocolConfig()">Save Protocol Configuration</button>
                    </div>
                    
                    <div class="result-display" id="protocol-result" style="display: none;">
                        Protocol configuration saved successfully!
                    </div>
                </div>

                <!-- Performance Tuning Screen -->
                <div class="config-screen" id="performance-tuning-screen">
                    <h2>Performance Tuning</h2>
                    
                    <div class="form-group">
                        <label for="cache-duration">Cache Duration (minutes):</label>
                        <input type="number" id="cache-duration" min="0" max="1440" value="15">
                    </div>
                    
                    <div class="form-group">
                        <label for="connection-pool">Connection Pool Size:</label>
                        <input type="number" id="connection-pool" min="1" max="100" value="10">
                    </div>
                    
                    <div class="form-group">
                        <label for="batch-size">Batch Processing Size:</label>
                        <input type="number" id="batch-size" min="1" max="1000" value="50">
                    </div>
                    
                    <div class="form-group">
                        <label for="compression">Enable Compression:</label>
                        <select id="compression">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button class="back-button" onclick="showWelcomeScreen()">Back</button>
                        <button onclick="savePerformanceTuning()">Save Performance Settings</button>
                    </div>
                    
                    <div class="result-display" id="performance-result" style="display: none;">
                        Performance settings saved successfully!
                    </div>
                </div>

                <!-- Validation Tools Screen -->
                <div class="config-screen" id="validation-screen">
                    <h2>SRU Validation Tools</h2>
                    
                    <div class="form-group">
                        <label for="query-test">Test CQL Query:</label>
                        <input type="text" id="query-test" placeholder="Enter CQL query to validate">
                    </div>
                    
                    <div class="form-group">
                        <button onclick="validateQuery()">Validate Query</button>
                    </div>
                    
                    <div class="result-display" id="query-validation-result" style="display: none;"></div>
                    
                    <h3>Connection Test</h3>
                    <div class="form-group">
                        <label for="connection-url">Server URL to Test:</label>
                        <input type="text" id="connection-url" placeholder="Enter SRU server URL to test">
                    </div>
                    
                    <div class="form-group">
                        <button onclick="testConnection()">Test Connection</button>
                    </div>
                    
                    <div class="result-display" id="connection-test-result" style="display: none;"></div>
                    
                    <h3>SRU Parameters Reference</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Description</th>
                                <th>Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>operation</td>
                                <td>The operation to perform (searchRetrieve, explain, scan)</td>
                                <td>Yes</td>
                            </tr>
                            <tr>
                                <td>version</td>
                                <td>SRU version (1.1, 1.2, 2.0)</td>
                                <td>Yes</td>
                            </tr>
                            <tr>
                                <td>query</td>
                                <td>CQL query string</td>
                                <td>Yes (for searchRetrieve)</td>
                            </tr>
                            <tr>
                                <td>recordSchema</td>
                                <td>Schema for returned records</td>
                                <td>No</td>
                            </tr>
                            <tr>
                                <td>maximumRecords</td>
                                <td>Maximum number of records to return</td>
                                <td>No</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="form-group">
                        <button class="back-button" onclick="showWelcomeScreen()">Back</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>SRU Standardization Tool &copy; 2025</p>
        </div>
    </div>

    <script>
        // Main navigation functions
        document.getElementById('proceed-button').addEventListener('click', function() {
            const selectedOption = document.getElementById('config-dropdown').value;
            if (!selectedOption) {
                alert('Please select a configuration option.');
                return;
            }
            
        showConfigScreen(selectedOption);
            
            // Pass the composition data to the next screen (in a real app, you'd do more with this)
            const compositionData = {
                h2s: parseFloat(document.getElementById('h2s').value) || 0,
                co2: parseFloat(document.getElementById('co2').value) || 0,
                nh3: parseFloat(document.getElementById('nh3').value) || 0,
                btex: parseFloat(document.getElementById('btex').value) || 0,
                otherHc: parseFloat(document.getElementById('other-hc').value) || 0
            };
            
            // Store in session storage for use in other screens
            sessionStorage.setItem('compositionData', JSON.stringify(compositionData));
        });
        
        function showConfigScreen(screenId) {
            // Hide welcome screen
            document.getElementById('welcome-screen').style.display = 'none';
            
            // Show config screens container
            document.getElementById('config-screens').style.display = 'block';
            
            // Hide all config screens
            const configScreens = document.getElementsByClassName('config-screen');
            for (let i = 0; i < configScreens.length; i++) {
                configScreens[i].style.display = 'none';
            }
            
            // Show the selected screen
            document.getElementById(screenId + '-screen').style.display = 'block';
        }
        
        function showWelcomeScreen() {
            // Hide all config screens
            document.getElementById('config-screens').style.display = 'none';
            
            // Show welcome screen
            document.getElementById('welcome-screen').style.display = 'block';
        }
        
        // Basic Parameters functions
        function saveBasicParameters() {
            const serverUrl = document.getElementById('server-url').value;
            const version = document.getElementById('version').value;
            const operation = document.getElementById('operation').value;
            const recordSchema = document.getElementById('record-schema').value;
            
            if (!serverUrl) {
                alert('Please enter a server URL.');
                return;
            }
            
            // In a real application, you would save these settings
            console.log('Basic Parameters:', {
                serverUrl,
                version,
                operation,
                recordSchema
            });
            
            // Show success message
            const resultElement = document.getElementById('basic-result');
            resultElement.textContent = 'Basic parameters saved successfully!';
            resultElement.style.display = 'block';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                resultElement.style.display = 'none';
            }, 3000);
        }
        
        // Advanced Settings functions
        function saveAdvancedSettings() {
            const maxRecords = document.getElementById('max-records').value;
            const startRecord = document.getElementById('start-record').value;
            const recordPacking = document.getElementById('record-packing').value;
            const stylesheet = document.getElementById('stylesheet').value;
            
            // In a real application, you would save these settings
            console.log('Advanced Settings:', {
                maxRecords,
                startRecord,
                recordPacking,
                stylesheet
            });
            
            // Show success message
            const resultElement = document.getElementById('advanced-result');
            resultElement.textContent = 'Advanced settings saved successfully!';
            resultElement.style.display = 'block';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                resultElement.style.display = 'none';
            }, 3000);
        }
        
        // Protocol Configuration functions
        function saveProtocolConfig() {
            const authMethod = document.getElementById('auth-method').value;
            const timeout = document.getElementById('timeout').value;
            const retryAttempts = document.getElementById('retry-attempts').value;
            const customHeaders = document.getElementById('custom-headers').value;
            
            // In a real application, you would save these settings
            console.log('Protocol Configuration:', {
                authMethod,
                timeout,
                retryAttempts,
                customHeaders
            });
            
            // Show success message
            const resultElement = document.getElementById('protocol-result');
            resultElement.textContent = 'Protocol configuration saved successfully!';
            resultElement.style.display = 'block';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                resultElement.style.display = 'none';
            }, 3000);
        }
        
        // Performance Tuning functions
        function savePerformanceTuning() {
            const cacheDuration = document.getElementById('cache-duration').value;
            const connectionPool = document.getElementById('connection-pool').value;
            const batchSize = document.getElementById('batch-size').value;
            const compression = document.getElementById('compression').value;
            
            // In a real application, you would save these settings
            console.log('Performance Tuning:', {
                cacheDuration,
                connectionPool,
                batchSize,
                compression
            });
            
            // Show success message
            const resultElement = document.getElementById('performance-result');
            resultElement.textContent = 'Performance settings saved successfully!';
            resultElement.style.display = 'block';
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                resultElement.style.display = 'none';
            }, 3000);
        }
        
        // Update PFD based on input values
        function updatePFD() {
            const h2s = parseFloat(document.getElementById('h2s').value) || 0;
            const co2 = parseFloat(document.getElementById('co2').value) || 0;
            const nh3 = parseFloat(document.getElementById('nh3').value) || 0;
            const btex = parseFloat(document.getElementById('btex').value) || 0;
            const otherHc = parseFloat(document.getElementById('other-hc').value) || 0;
            
            // Update feed component labels
            document.getElementById('feed-h2s').textContent = `H₂S: ${h2s.toFixed(2)}%`;
            document.getElementById('feed-co2').textContent = `CO₂: ${co2.toFixed(2)}%`;
            document.getElementById('feed-nh3').textContent = `NH₃: ${nh3.toFixed(2)}%`;
            
            // Calculate estimated sulfur purity based on feed composition
            // This is a simplified calculation for demonstration
            let purity = 0;
            if (h2s > 0) {
                // Higher H2S typically means better conversion efficiency
                purity = 90 + (h2s / 10);
                
                // Reduce purity if there are impurities
                if (co2 > 5) purity -= (co2 - 5) * 0.5;
                if (nh3 > 2) purity -= (nh3 - 2) * 1;
                if (btex > 1) purity -= btex * 2;
                if (otherHc > 3) purity -= (otherHc - 3) * 0.8;
                
                // Clamp purity to reasonable values
                purity = Math.min(99.9, Math.max(80, purity));
            }
            
            document.getElementById('sulfur-output').textContent = `Purity: ${purity.toFixed(2)}%`;
            
            // Color code reactor based on H2S content
            const reactor = document.getElementById('reactor');
            if (h2s < 5) {
                reactor.setAttribute('fill', '#ffcccc'); // Low H2S - potential issues
            } else if (h2s > 40) {
                reactor.setAttribute('fill', '#ffeecc'); // High H2S - different concerns
            } else {
                reactor.setAttribute('fill', '#ccffcc'); // Optimal range
            }
            
            // Color code converters based on estimated efficiency
            const converter1 = document.getElementById('converter1');
            const converter2 = document.getElementById('converter2');
            
            if (purity > 95) {
                converter1.setAttribute('fill', '#ccffcc');
                converter2.setAttribute('fill', '#ccffcc');
            } else if (purity > 90) {
                converter1.setAttribute('fill', '#e6ffcc');
                converter2.setAttribute('fill', '#e6ffcc');
            } else if (purity > 85) {
                converter1.setAttribute('fill', '#ffffcc');
                converter2.setAttribute('fill', '#ffffcc');
            } else {
                converter1.setAttribute('fill', '#ffeecc');
                converter2.setAttribute('fill', '#ffeecc');
            }
            
            // Update conversion text descriptions based on composition
            let conv1Text = "H₂S → SO₂";
            let conv2Text = "SO₂ → S";
            
            if (nh3 > 3) {
                conv1Text += " + NH₃ catalytic";
            }
            if (btex > 2) {
                conv1Text += " (HC risk)";
            }
            
            document.getElementById('converter1-text').textContent = conv1Text;
            document.getElementById('converter2-text').textContent = conv2Text;
        }
        
        // Composition calculation function
        function calculateComposition() {
            const h2s = parseFloat(document.getElementById('h2s').value) || 0;
            const co2 = parseFloat(document.getElementById('co2').value) || 0;
            const nh3 = parseFloat(document.getElementById('nh3').value) || 0;
            const btex = parseFloat(document.getElementById('btex').value) || 0;
            const otherHc = parseFloat(document.getElementById('other-hc').value) || 0;
            
            const total = h2s + co2 + nh3 + btex + otherHc;
            
            const totalElement = document.getElementById('total-composition');
            totalElement.textContent = `Total: ${total.toFixed(2)}%`;
            
            // Optional: Provide feedback if total is not 100%
            if (Math.abs(total - 100) > 0.01) {
                totalElement.style.color = '#dc3545';
                totalElement.textContent += ' (Note: Total should be 100%)';
            } else {
                totalElement.style.color = '#28a745';
            }
            
            // Update the PFD as well
            updatePFD();
        }
        
            const query = document.getElementById('query-test').value;
            
            if (!query) {
                alert('Please enter a CQL query to validate.');
                return;
            }
            
            // In a real application, you would validate the query against CQL syntax
            // For this demo, we'll simulate validation
            const isValid = validateCQL(query);
            
            const resultElement = document.getElementById('query-validation-result');
            if (isValid) {
                resultElement.textContent = 'Query is valid CQL syntax.';
                resultElement.style.backgroundColor = '#d4edda';
            } else {
                resultElement.textContent = 'Invalid CQL syntax. Please check your query.';
                resultElement.style.backgroundColor = '#f8d7da';
            }
            resultElement.style.display = 'block';
        }
        
        function validateCQL(query) {
            // This is a simplified validation
            // In a real application, this would be a proper CQL syntax validator
            const commonCQLTerms = ['and', 'or', 'not', '=', '>=', '<=', '<>', 'all', 'any'];
            const containsCommonTerms = commonCQLTerms.some(term => 
                query.toLowerCase().includes(term)
            );
            
            // Very basic check that there's at least one term and an operator
            return query.length > 3 && containsCommonTerms;
        }
        
        function testConnection() {
            const connectionUrl = document.getElementById('connection-url').value;
            
            if (!connectionUrl) {
                alert('Please enter a server URL to test.');
                return;
            }
            
            // In a real application, you would test the connection
            // For this demo, we'll simulate a connection test
            const resultElement = document.getElementById('connection-test-result');
            
            // Simulate connection delay
            resultElement.textContent = 'Testing connection...';
            resultElement.style.backgroundColor = '#e2e3e5';
            resultElement.style.display = 'block';
            
            setTimeout(() => {
                // Simulate success or failure
                const isSuccess = Math.random() > 0.3; // 70% success rate for demo
                
                if (isSuccess) {
                    resultElement.textContent = 'Connection successful! Server is responding properly.';
                    resultElement.style.backgroundColor = '#d4edda';
                } else {
                    resultElement.textContent = 'Connection failed. Please check the URL and server status.';
                    resultElement.style.backgroundColor = '#f8d7da';
                }
            }, 1500);
        }
    </script>
</body>
</html>